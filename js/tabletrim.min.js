!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(c){return a.tabletrim=b(c)}):a.tabletrim=b(a.jQuery)}(this,function(a){return function(b,c){var d={select:!0,prev:!1,next:!1,label:!1,prevhtml:"&lsaquo;",nexthtml:"&rsaquo;",labelhtml:"Column: ",sticky:1,init:2,breakpoint:640,lag:100,oninit:null,ontrim:null,onuntrim:null,onactivate:null,ondeactivate:null},e={table:"tabletrim",rtl:"tabletrim-rtl",ltr:"tabletrim-ltr",controls:"tabletrim-controls",prev:"tabletrim-prev",next:"tabletrim-next",select:"tabletrim-select",trimmed:"tabletrim-trimmed",active:"tabletrim-active",sticky:"tabletrim-sticky",breakpoints:640},f={rootid:null,trimmed:!1,activeindex:null,timeout:null,columns:null},g={window:a(window)},h=[];return _private={init:function(b,c){return a.extend(d,c),g.table=b,g.table.addClass(e.table),_private.setId(),_private.build(),g.window.on("resize",_private.resize),"function"==typeof d.oninit&&d.oninit(g.table),_private.check(),_public},build:function(){g.select=a('<select class="'+e.select+'"></select'),d.prev&&(g.prev=a('<button class="'+e.prev+'">'+d.prevhtml+"</button>")),d.next&&(g.next=a('<button class="'+e.next+'">'+d.nexthtml+"</button>")),d.label&&(g.select.attr("id","tabletrim-select-"+f.id),g.label=a('<label for="tabletrim-select-'+f.id+'">'+d.labelhtml+"</label>")),g.table.find("thead th").each(function(){f.columns=null==f.columns?1:f.columns+1;var b=a(this).index()+1;h[b]={index:b,title:a(this).html(),headercell:a(this),allcells:g.table.find("tr th:nth-child("+b+"), tr td:nth-child("+b+")"),bodycells:g.table.find("tbody tr th:nth-child("+b+"), tbody tr td:nth-child("+b+")")};var c=b==d.sticky?' disabled="disabled"':"";a('<option value="'+b+'"'+c+"></option>").text(h[b].title).appendTo(g.select)}),g.controls=a('<div class="'+e.controls+'"></div>'),d.select&&g.controls.append(g.select),d.prev&&g.controls.append(g.prev),d.next&&g.controls.append(g.next),d.label&&g.controls.prepend(g.label),f.activeindex=d.init,d.select&&g.select.on("change",function(){var b=a(this).find(":selected").val();_private.activate(b)}),d.prev&&g.prev.on("click",function(a){a.preventDefault(),_private.activate(f.prev)}),d.next&&g.next.on("click",function(a){a.preventDefault(),_private.activate(f.next)})},setId:function(){f.id=Math.random().toString(36).substr(2,6),a("table[data-tabletrimid="+f.id+"]").length&&_private.setId(),g.table.attr("data-tabletrimid",f.id)},setIndexes:function(){nextdelta=f.activeindex+1==d.sticky?2:1,prevdelta=f.activeindex-1==d.sticky?2:1,f.next=f.activeindex+nextdelta<=f.columns?f.activeindex+nextdelta:1,f.prev=f.activeindex-prevdelta>0?f.activeindex-prevdelta:f.columns},resize:function(){clearInterval(f.timeout),f.timeout=setTimeout(_private.check,d.lag)},check:function(){g.table.width()>d.breakpoint&&f.trimmed&&_private.untrim(),g.table.width()<=d.breakpoint&&!f.trimmed&&_private.trim(d.init)},trim:function(a){return f.trimmed?!1:("undefined"==typeof a&&(a=d.init),g.table.addClass(e.trimmed),"function"==typeof d.ontrim&&d.ontrim(g.table),f.trimmed=!0,_private.activate(d.sticky),void _private.activate(a))},untrim:function(){return f.trimmed?(g.table.removeClass(e.trimmed+" "+e.rtl+" "+e.ltr),"function"==typeof d.onuntrim&&d.onuntrim(g.table),_private.deactivate(g.table),void(f.trimmed=!1)):!1},activate:function(a){return f.trimmed?(a==d.sticky?h[a].allcells.addClass(e.sticky):(_private.deactivate(),a>d.sticky?g.table.removeClass(e.rtl).addClass(e.ltr):g.table.removeClass(e.ltr).addClass(e.rtl),f.activeindex=parseInt(a),_private.addcontrols(),h[a].allcells.addClass(e.active),"function"==typeof d.onactivate&&a!=d.sticky&&d.onactivate(g.table,h[a])),void _private.setIndexes()):void _private.trim(a)},deactivate:function(){h[f.activeindex].allcells.removeClass(e.active),_private.removecontrols(),"function"==typeof d.ondeactivate&&d.ondeactivate(g.table,h[f.activeindex])},addcontrols:function(){if(f.activeindex==d.sticky)return!1;d.select&&(g.select.find("option:selected").removeAttr("selected"),g.select.find("option:nth-child("+f.activeindex+")").attr("selected","selected"));var a=g.controls.clone(!0);h[f.activeindex].headercell.empty().append(a)},removecontrols:function(){h[f.activeindex].headercell.empty().text(h[f.activeindex].title)}},_public={trim:function(a){_private.trim(a)},untrim:function(){_private.untrim()},activate:function(a){_private.activate(a)}},_private.init(b,c)}});