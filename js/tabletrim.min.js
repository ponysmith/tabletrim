(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(a.tabletrim=b(c))})}else{a.tabletrim=b(a.jQuery)}}(this,function(a){return function(h,f){var b={select:true,prev:true,next:true,prevhtml:"&lsaquo;",nexthtml:"&rsaquo;",sticky:1,init:2,breakpoint:640,lag:100,};var d={table:"tabletrim",rtl:"tabletrim-rtl",ltr:"tabletrim-ltr",controls:"tabletrim-controls",prev:"tabletrim-prev",next:"tabletrim-next",select:"tabletrim-select",trimmed:"tabletrim-trimmed",active:"tabletrim-active",sticky:"tabletrim-sticky",breakpoints:640};var e={trimmed:false,activeindex:null,timeout:null,columns:null};var g={window:a(window)};var c=[];_private={init:function(j,i){a.extend(b,i);g.table=j;g.table.addClass(d.table);_private.build();g.window.on("resize",_private.resize);_private.check();return _public},build:function(){g.select=a('<select class="'+d.select+'"></select');if(b.prev){g.prev=a('<button class="'+d.prev+'">'+b.prevhtml+"</button>")}if(b.next){g.next=a('<button class="'+d.next+'">'+b.nexthtml+"</button>")}g.table.find("thead th").each(function(){e.columns=(e.columns==null)?1:e.columns+1;var i=a(this).index()+1;c[i]={index:i,title:a(this).html(),headercell:a(this),allcells:g.table.find("tr th:nth-child("+i+"), tr td:nth-child("+i+")"),bodycells:g.table.find("tbody tr th:nth-child("+i+"), tbody tr td:nth-child("+i+")")};var j=(i==b.sticky)?' disabled="disabled"':"";a('<option value="'+i+'"'+j+"></option>").text(c[i].title).appendTo(g.select)});g.controls=a('<div class="'+d.controls+'"></div>');if(b.select){g.controls.append(g.select)}if(b.prev){g.controls.append(g.prev)}if(b.next){g.controls.append(g.next)}e.activeindex=b.init;if(b.select){g.select.on("change",function(){var i=a(this).find(":selected").val();_private.activate(i)})}if(b.prev){g.prev.on("click",function(i){i.preventDefault();_private.activate(e.prev)})}if(b.next){g.next.on("click",function(i){i.preventDefault();_private.activate(e.next)})}},setIndexes:function(){nextdelta=(e.activeindex+1==b.sticky)?2:1;prevdelta=(e.activeindex-1==b.sticky)?2:1;e.next=(e.activeindex+nextdelta<e.columns)?e.activeindex+nextdelta:1;e.prev=(e.activeindex-prevdelta>0)?e.activeindex-prevdelta:e.columns},resize:function(){clearInterval(e.timeout);e.timeout=setTimeout(_private.check,b.lag)},check:function(){if(g.window.width()>b.breakpoint&&e.trimmed){_private.untrim()}if(g.window.width()<=b.breakpoint&&!e.trimmed){_private.trim(b.init)}},trim:function(j){g.table.addClass(d.trimmed);_private.activate(b.sticky);_private.activate(j);e.trimmed=true},untrim:function(){g.table.removeClass(d.trimmed+" "+d.rtl+" "+d.ltr);_private.deactivate();e.trimmed=false},activate:function(j){_private.deactivate();if(j==b.sticky){c[j].allcells.addClass(d.sticky)}else{(j>b.sticky)?g.table.removeClass(d.rtl).addClass(d.ltr):g.table.removeClass(d.ltr).addClass(d.rtl);e.activeindex=parseInt(j);_private.addcontrols();c[j].allcells.addClass(d.active)}_private.setIndexes()},deactivate:function(){c[e.activeindex].allcells.removeClass(d.active);_private.removecontrols()},addcontrols:function(){if(e.activeindex==b.sticky){return false}if(b.select){g.select.find("option:selected").removeAttr("selected");g.select.find("option:nth-child("+e.activeindex+")").attr("selected","selected")}var i=g.controls.clone(true);c[e.activeindex].headercell.empty().append(i)},removecontrols:function(){c[e.activeindex].headercell.empty().text(c[e.activeindex].title)}};_public={trim:function(j){_private.trim(j)},untrim:function(){_private.untrim()},};return _private.init(h,f)}}));