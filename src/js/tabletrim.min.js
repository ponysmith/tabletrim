!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(i){return t.tabletrim=e(i)}):t.tabletrim=e(t.jQuery)}(this,function(t){return function(e,n){var l={controls:["select"],prevhtml:"&lsaquo;",nexthtml:"&rsaquo;",labelhtml:"Column: ",sticky:1,init:2,breakpoint:640,lag:100,oninit:null,ontrim:null,onuntrim:null,onactivate:null,ondeactivate:null},a={table:"tabletrim",rtl:"tabletrim-rtl",ltr:"tabletrim-ltr",controls:"tabletrim-controls",title:"tabletrim-title",prev:"tabletrim-prev",next:"tabletrim-next",select:"tabletrim-select",trimmed:"tabletrim-trimmed",active:"tabletrim-active",sticky:"tabletrim-sticky"},r={rootid:null,trimmed:!1,activeindex:null,timeout:null,columns:null},c={window:t(window)},o=[];return _private={init:function(e,i){return t.extend(l,i),c.table=e,c.table.addClass(a.table),_private.setId(),_private.build(),c.window.on("resize",_private.resize),"function"==typeof l.oninit&&l.oninit(c.table),_private.check(),_public},build:function(){if(c.options=[],c.table.find("thead th").each(function(){r.columns=null==r.columns?1:r.columns+1;var e=t(this).index()+1;o[e]={index:e,title:t(this).html(),headercell:t(this),allcells:c.table.find("tr th:nth-child("+e+"), tr td:nth-child("+e+")"),bodycells:c.table.find("tbody tr th:nth-child("+e+"), tbody tr td:nth-child("+e+")")};var i=l.sticky>0&&e==l.sticky?' disabled="disabled"':"";c.options.push(t('<option value="'+e+'"'+i+">"+o[e].title+"</option>"))}),"object"==typeof l.controls)for(c.controls=t('<div class="'+a.controls+'"></div>'),i=0;i<l.controls.length;i++){var e=l.controls[i];switch(e){case"select":c.select=t('<select class="'+a.select+'"></select').append(c.options).attr("id","tabletrim-select-"+r.id),c.select.appendTo(c.controls),c.select.on("change",function(){var e=t(this).find(":selected").val();_private.activate(e)});break;case"label":c.label=t('<label for="tabletrim-select-'+r.id+'">'+l.labelhtml+"</label>").appendTo(c.controls);break;case"title":c.title=t('<span class="'+a.title+'" />').appendTo(c.controls);break;case"prev":c.prev=t('<button class="'+a.prev+'">'+l.prevhtml+"</button>").appendTo(c.controls),c.prev.on("click",function(t){t.preventDefault(),_private.activate(r.prev)});break;case"next":c.next=t('<button class="'+a.next+'">'+l.nexthtml+"</button>").appendTo(c.controls),c.next.on("click",function(t){t.preventDefault(),_private.activate(r.next)})}}r.activeindex=l.init},setId:function(){r.id=Math.random().toString(36).substr(2,6),t("table[data-tabletrimid="+r.id+"]").length&&_private.setId(),c.table.attr("data-tabletrimid",r.id)},setIndexes:function(){nextdelta=r.activeindex+1==l.sticky?2:1,prevdelta=r.activeindex-1==l.sticky?2:1,r.next=r.activeindex+nextdelta<=r.columns?r.activeindex+nextdelta:1==l.sticky?2:1,r.prev=r.activeindex-prevdelta>0?r.activeindex-prevdelta:r.columns==l.sticky?r.columns-1:r.columns},resize:function(){clearInterval(r.timeout),r.timeout=setTimeout(_private.check,l.lag)},check:function(){c.table.width()>l.breakpoint&&r.trimmed&&_private.untrim(),c.table.width()<=l.breakpoint&&!r.trimmed&&_private.trim(l.init)},trim:function(t){return!r.trimmed&&("undefined"==typeof t&&(t=l.init),c.table.addClass(a.trimmed),"function"==typeof l.ontrim&&l.ontrim(c.table),r.trimmed=!0,l.sticky>0&&_private.activate(l.sticky),void _private.activate(t))},untrim:function(){return!!r.trimmed&&(c.table.removeClass(a.trimmed+" "+a.rtl+" "+a.ltr),"function"==typeof l.onuntrim&&l.onuntrim(c.table),_private.deactivate(c.table),void(r.trimmed=!1))},activate:function(t){return r.trimmed?(l.sticky>0&&t==l.sticky?o[t].allcells.addClass(a.sticky):(_private.deactivate(),t>l.sticky?c.table.removeClass(a.rtl).addClass(a.ltr):c.table.removeClass(a.ltr).addClass(a.rtl),r.activeindex=parseInt(t),_private.addcontrols(),o[t].allcells.addClass(a.active),"function"==typeof l.onactivate&&t!=l.sticky&&l.onactivate(c.table,o[t])),void _private.setIndexes()):void _private.trim(t)},deactivate:function(){o[r.activeindex].allcells.removeClass(a.active),_private.removecontrols(),"function"==typeof l.ondeactivate&&l.ondeactivate(c.table,o[r.activeindex])},addcontrols:function(){if(r.activeindex==l.sticky)return!1;l.controls.indexOf("select")!=-1&&(c.select.find("option:selected").removeAttr("selected"),c.select.find("option:nth-child("+r.activeindex+")").attr("selected","selected")),l.controls.indexOf("title")!=-1&&c.title.html(o[r.activeindex].title);var t=c.controls.clone(!0);o[r.activeindex].headercell.empty().append(t)},removecontrols:function(){o[r.activeindex].headercell.empty().text(o[r.activeindex].title)}},_public={trim:function(t){_private.trim(t)},untrim:function(){_private.untrim()},activate:function(t){_private.activate(t)}},_private.init(e,n)}});