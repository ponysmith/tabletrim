var tabletrim=function(t,e){var i={controls:["select"],prevhtml:"&lsaquo;",nexthtml:"&rsaquo;",labelhtml:"Column: ",sticky:1,init:2,breakpoint:640,oninit:function(){},ontrim:function(){},onuntrim:function(){},onactivate:function(){},ondeactivate:function(){}},n={table:"tt",rtl:"tt-rtl",ltr:"tt-ltr",controls:"tt-controls",title:"tt-title",prev:"tt-prev",next:"tt-next",label:"tt-label",select:"tt-select",trimmed:"tt-trimmed",active:"tt-active",sticky:"tt-sticky"},l={id:null,trimmed:!1,activeindex:null,timeout:null,columns:null},a={},c=[];return _private={init:function(t,e){if(t instanceof HTMLTableElement==0)throw new TypeError("[tabletrim] First parameter passed to tabletrim() must be an HTMLTableElement");return a.table=t,a.table.classList.add(n.table),l.id=_private.getId(),l.activeindex=i.init,_private.buildColumns(),_private.mergeOptions(e),_private.buildControls(),_private.bindEvents(),_private.check(),"function"==typeof i.oninit&&i.oninit(a.table),_public},mergeOptions:function(t){for(o in t)null!=i[o]&&(i[o]=t[o]);if(i.sticky<1||i.sticky>l.columns)throw new Error("`options.sticky` must be greater than 0 and cannot be greater than the number of table columns ("+l.columns+")");if(i.init<1||i.init>l.columns)throw new Error("`options.sticky` must be greater than 0 and cannot be greater than the number of table columns ("+l.columns+")");if(i.init==i.sticky)throw new Error("`options.init` must not be the same as `options.sticky`")},getId:function(){return Math.random().toString(36).substr(2,6)},buildColumns:function(){var t=[].slice.call(a.table.querySelectorAll("thead th"));t.forEach(function(t,e){e++,c[e]={index:e,title:t.innerHTML,headercell:t,allcells:[].slice.call(a.table.querySelectorAll("tr th:nth-child("+e+"), tr td:nth-child("+e+")")),bodycells:[].slice.call(a.table.querySelectorAll("tbody tr th:nth-child("+e+"), tbody tr td:nth-child("+e+")"))}}),l.columns=t.length},buildControls:function(){"object"==typeof i.controls&&(a.controls=document.createElement("div"),a.controls.classList.add(n.controls),i.controls.forEach(function(t,e){switch(t){case"select":a.select=document.createElement("select"),a.select.id="tt-select-"+l.id,a.select.classList.add(n.select),a.select.onchange=function(){var t=a.select.selectedOptions[0].value;_private.activate(t)},c.forEach(function(t){var e=document.createElement("option");e.value=t.index,e.innerHTML=t.title,i.sticky>0&&i.sticky==t.index&&(e.disabled=!0),a.select.appendChild(e),a.controls.appendChild(a.select)});break;case"label":a.label=document.createElement("label"),a.label.classList.add(n.label),a.label.htmlFor="tt-select-"+l.id,a.label.innerHTML=i.labelhtml,a.controls.appendChild(a.label);break;case"title":a.title=document.createElement("span"),a.title.classList.add(n.title),a.controls.appendChild(a.title);break;case"prev":a.prev=document.createElement("button"),a.prev.classList.add(n.prev),a.prev.innerHTML=i.prevhtml,a.prev.onclick=function(t){_private.activate(l.prev)},a.controls.appendChild(a.prev);break;case"next":a.next=document.createElement("button"),a.next.classList.add(n.next),a.next.innerHTML=i.nexthtml,a.next.onclick=function(t){_private.activate(l.next)},a.controls.appendChild(a.next)}}))},bindEvents:function(){window.addEventListener("resize",_private.check),window.addEventListener("scroll",_private.check)},check:function(){a.table.offsetWidth<=i.breakpoint&&!l.trimmed&&_private.trim(),a.table.offsetWidth>i.breakpoint&&l.trimmed&&_private.untrim()},updateIndexes:function(){nextdelta=l.activeindex+1==i.sticky?2:1,prevdelta=l.activeindex-1==i.sticky?2:1,l.next=l.activeindex+nextdelta<=l.columns?l.activeindex+nextdelta:1==i.sticky?2:1,l.prev=l.activeindex-prevdelta>0?l.activeindex-prevdelta:l.columns==i.sticky?l.columns-1:l.columns},trim:function(t){return!l.trimmed&&("undefined"==typeof t&&(t=i.init),a.table.classList.add(n.trimmed),"function"==typeof i.ontrim&&i.ontrim(a.table),l.trimmed=!0,i.sticky>0&&_private.activate(i.sticky),void _private.activate(t))},untrim:function(){return!!l.trimmed&&(a.table.classList.remove(n.trimmed,n.rtl,n.ltr),"function"==typeof i.onuntrim&&i.onuntrim(a.table),_private.deactivate(a.table),void(l.trimmed=!1))},activate:function(t){return t=parseFloat(t),l.trimmed?(i.sticky>0&&t==i.sticky?c[t].allcells.forEach(function(t){t.classList.add(n.sticky)}):(_private.deactivate(),t>i.sticky?(a.table.classList.remove(n.rtl),a.table.classList.add(n.ltr)):(a.table.classList.remove(n.ltr),a.table.classList.add(n.rtl)),l.activeindex=parseInt(t),_private.addControls(),c[t].allcells.forEach(function(t){t.classList.add(n.active)}),"function"==typeof i.onactivate&&t!=i.sticky&&i.onactivate(a.table,c[t])),void _private.updateIndexes()):void _private.trim(t)},deactivate:function(){c[l.activeindex].allcells.forEach(function(t){t.classList.remove(n.active)}),_private.removeControls(),"function"==typeof i.ondeactivate&&i.ondeactivate(a.table,c[l.activeindex])},addControls:function(){return l.activeindex!=i.sticky&&(i.controls.indexOf("select")!=-1&&(a.select.selectedOptions[0].removeAttribute("selected"),a.select.querySelector("option:nth-child("+l.activeindex+")").selected="selected"),i.controls.indexOf("title")!=-1&&(a.title.innerHTML=c[l.activeindex].title),c[l.activeindex].headercell.innerHTML="",void c[l.activeindex].headercell.appendChild(a.controls))},removeControls:function(){c[l.activeindex].headercell.innerHTML=c[l.activeindex].title}},_public={trim:function(t){_private.trim(t)},untrim:function(){_private.untrim()},activate:function(t){_private.activate(t)}},_private.init(t,e)};